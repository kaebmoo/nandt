<!-- templates/partials/navbar.html -->
{% set nav_params = get_nav_params() %}
<nav class="bg-white shadow-sm border-b sticky top-0 z-40">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <div class="flex justify-between items-center h-16">
            <div class="flex items-center">
                <div class="flex-shrink-0">
                    <a href="{{ url('main.dashboard') }}" class="flex items-center space-x-3">
                        <svg class="w-8 h-8 text-purple-600" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M10.894 2.553a1 1 0 00-1.788 0l-7 14a1 1 0 001.169 1.409l5-1.429A1 1 0 009 15.571V11a1 1 0 112 0v4.571a1 1 0 00.725.962l5 1.428a1 1 0 001.17-1.408l-7-14z"/>
                        </svg>
                        <h1 class="text-xl font-bold text-gray-900">NudDee</h1>
                    </a>
                </div>
            </div>
            
            <!-- User Menu -->
            {% if get_current_user() %}
            <div class="flex items-center space-x-4">
                <span class="text-sm text-gray-500">{{ get_current_user().hospital.name if get_current_user().hospital else '‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£' }}</span>
                
                <!-- User Dropdown -->
                <div class="relative group">
                    <button class="flex items-center space-x-2 text-gray-700 hover:text-gray-900">
                        <div class="w-8 h-8 bg-purple-100 rounded-full flex items-center justify-center">
                            <span class="text-sm font-medium text-purple-600">
                                {{ get_current_user().name[0] if get_current_user().name else 'U' }}
                            </span>
                        </div>
                        <span class="text-sm font-medium">{{ get_current_user().name if get_current_user().name else '‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ' }}</span>
                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
                        </svg>
                    </button>
                    
                    <!-- Dropdown Menu -->
                    <div class="absolute right-0 mt-2 w-48 bg-white rounded-md shadow-lg py-1 z-50 opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-200">
                        <div class="px-4 py-2 border-b">
                            <p class="text-sm font-medium text-gray-900">{{ get_current_user().name }}</p>
                            <p class="text-xs text-gray-500">{{ get_current_user().email }}</p>
                        </div>
                        <a href="{{ url('main.dashboard') }}" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100">
                            üè† ‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å
                        </a>
                        <a href="{{ url('auth.profile') }}" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100">
                            üë§ ‡πÇ‡∏õ‡∏£‡πÑ‡∏ü‡∏•‡πå
                        </a>
                        <a href="{{ url('availability.availability_settings') }}" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100">
                            üïê ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏≥‡∏Å‡∏≤‡∏£
                        </a>
                        <a href="{{ url('main.event_types_settings') }}" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100">
                            üìÖ ‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏Å‡∏≤‡∏£‡∏ô‡∏±‡∏î‡∏´‡∏°‡∏≤‡∏¢
                        </a>
                        <a href="{{ url('holidays.holiday_settings') }}" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100">
                            üìÖ ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏ß‡∏±‡∏ô‡∏´‡∏¢‡∏∏‡∏î
                        </a>
                        <!-- Public Booking Link -->
                        {% if nav_params.subdomain %}
                        <div class="border-t mt-2 pt-2">
                            <a href="{{ url('booking.booking_home') }}" 
                               target="_blank"
                               class="block px-4 py-2 text-sm text-purple-600 hover:bg-purple-50">
                                üîó ‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠‡∏á‡∏™‡∏≤‡∏ò‡∏≤‡∏£‡∏ì‡∏∞
                            </a>
                        </div>
                        {% endif %}
                        
                        <div class="border-t">
                            <a href="{{ url_for('auth.logout') }}" class="block px-4 py-2 text-sm text-red-600 hover:bg-red-50">
                                üö™ ‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö
                            </a>
                        </div>
                    </div>
                </div>
            </div>
            {% else %}
            <div class="flex items-center space-x-4">
                <a href="{{ url_for('auth.login') }}" class="text-sm text-gray-600 hover:text-gray-900">
                    ‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö
                </a>
            </div>
            {% endif %}
        </div>
    </div>
</nav>